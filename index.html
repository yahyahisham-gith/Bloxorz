<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bloxorz - Local Server</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background: #222; color: white; margin: 0; }
        #game-ui { background: #333; padding: 20px; border-radius: 10px; text-align: center; }
        iframe { display: none; width: 100%; height: 100vh; border: none; }
        input, button { margin: 10px; padding: 10px; border-radius: 5px; border: none; }
        button { cursor: pointer; background: #444; color: white; }
        button:hover { background: #666; }
    </style>
</head>
<body>

    <div id="game-ui">
        <h1>Bloxorz</h1>
        <input type="text" id="nameInput" placeholder="Enter Name">
        <br>
        <button onclick="handlePlay('chosen')">Play Now</button>
        <button onclick="handlePlay('random')">Use Randomized Name</button>
        <br>
        <button onclick="startNoSave()">Don't Save My Data</button>
        <p id="msg"></p>
    </div>

    <iframe id="gameFrame" src="https://classroom8.github.io/bloxorz/"></iframe>

    <script>
        function setOneTimeCookie(name) {
            document.cookie = `user_name_token=${encodeURI(name)}; path=/; max-age=60`;
        }

async function handlePlay(type) {
    let name = document.getElementById('nameInput').value;
    let route = '/create-chosen-name';

    if (type === 'random') {
        const adjectives = ["Cool", "Fast", "Smart", "Brave"];
        const nouns = ["Block", "Cube", "Edge", "Grid"];
        name = adjectives[Math.floor(Math.random() * adjectives.length)] + 
               nouns[Math.floor(Math.random() * nouns.length)] + 
               Math.floor(Math.random() * 99);
        route = '/create-randomized-name';
    }

    if (!name) return alert("Enter a name!");

    // Only try to save if we are running locally on your server
    if (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1") {
        setOneTimeCookie(name);
        try {
            // Pointing to your specific port 3001
            const response = await fetch(`http://localhost:3001${route}`);
            if (response.ok) {
                console.log("Local folder created successfully.");
            }
        } catch (err) {
            console.log("Server not running locally, skipping save.");
        }
    } else {
        console.log("Running on Web (GitHub/Netlify). Folder creation skipped.");
    }
    
    launchGame();
}
    </script>
</body>
</html>
